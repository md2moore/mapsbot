{"version":3,"sources":["../src/util.js"],"names":["promiseTimeout","packageIdentifier","escape","s","replace","ms","promise","timeout","Promise","resolve","reject","id","setTimeout","clearTimeout","race","addons","identifierMap","Object","assign","name","version","platform","release","node","process","keys","reduce","acc","k"],"mappings":";;;;;QAKgBA,c,GAAAA,c;QAsBAC,iB,GAAAA,iB;;AA3BhB;;;;AACA;;;;;;AAEA,SAASC,MAAT,CAAgBC,CAAhB,EAAmB;AAAE,SAAOA,EAAEC,OAAF,CAAU,GAAV,EAAe,GAAf,EAAoBA,OAApB,CAA4B,GAA5B,EAAiC,GAAjC,CAAP;AAA+C;;AAE7D,SAASJ,cAAT,CAAwBK,EAAxB,EAA4BC,OAA5B,EAAqC;AAC1C;AACA,MAAMC,UAAU,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC/C,QAAMC,KAAKC,WAAW,YAAM;AAC1BC,mBAAaF,EAAb;AACAD,aAAO,mBAAP;AACD,KAHU,EAGRL,EAHQ,CAAX;AAID,GALe,CAAhB;AAMA;AACA,SAAOG,QAAQM,IAAR,CAAa,CAClBR,OADkB,EAElBC,OAFkB,CAAb,CAAP;AAID;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASN,iBAAT,GAAwC;AAAA,MAAbc,MAAa,uEAAJ,EAAI;;AAC7C,MAAMC,gBAAgBC,OAAOC,MAAP,CAAc;AAClC,KAAE,GAAE,kBAAIC,IAAK,EAAb,GAAiB,kBAAIC,OADa;AAElC,KAAE,GAAE,aAAGC,QAAH,EAAc,EAAlB,GAAsB,aAAGC,OAAH,EAFY;AAGlCC,UAAMC,QAAQJ,OAAR,CAAgBhB,OAAhB,CAAwB,GAAxB,EAA6B,EAA7B;AAH4B,GAAd,EAInBW,MAJmB,CAAtB;AAKA,SAAOE,OAAOQ,IAAP,CAAYT,aAAZ,EAA2BU,MAA3B,CAAkC,UAACC,GAAD,EAAMC,CAAN;AAAA,WAAa,GAAED,GAAI,IAAGzB,OAAO0B,CAAP,CAAU,IAAG1B,OAAOc,cAAcY,CAAd,CAAP,CAAyB,EAA5D;AAAA,GAAlC,EAAiG,EAAjG,CAAP;AACD","file":"util.js","sourcesContent":["import os from 'os';\nimport pkg from '../package.json';\n\nfunction escape(s) { return s.replace('/', ':').replace(' ', '_'); }\n\nexport function promiseTimeout(ms, promise) {\n  // Create a promise that rejects in <ms> milliseconds\n  const timeout = new Promise((resolve, reject) => {\n    const id = setTimeout(() => {\n      clearTimeout(id);\n      reject('Promise timed out');\n    }, ms);\n  });\n  // Returns a race between our timeout and the passed in promise\n  return Promise.race([\n    promise,\n    timeout,\n  ]);\n}\n\n// NOTE: before this can be an external module:\n// 1. are all the JS features supported back to a reasonable version?\n//    default params, template strings, computed property names\n// 2. access to `pkg` will change\n// 3. tests\n// there will potentially be more named exports in this file\n// eslint-disable-next-line import/prefer-default-export\nexport function packageIdentifier(addons = {}) {\n  const identifierMap = Object.assign({\n    [`${pkg.name}`]: pkg.version,\n    [`${os.platform()}`]: os.release(),\n    node: process.version.replace('v', ''),\n  }, addons);\n  return Object.keys(identifierMap).reduce((acc, k) => `${acc} ${escape(k)}/${escape(identifierMap[k])}`, '');\n}\n"]}